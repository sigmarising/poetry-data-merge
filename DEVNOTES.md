# 开发笔记

## 1. 数据来源

* [国学大师 - 诗词曲库](http://www.guoxuedashi.com/shici/)
* [八斗文学](http://www.8dou.net/)

## 2. 数据预处理

* 使用工程1的原始 input 数据（`input\guoxuedashi`）
* 使用工程2的 output 数据（`input\8dou`）

手动进行下列处理：
1. 移除八斗文学数据集的：`不明`、`当代`、`近代`、`现代`
2. 统一两批数据集朝代：`元`、`先秦`、`南北朝`、`唐`、`宋`、`明`、`汉`、`清`、`辽`、`金`、`隋`、`魏晋`
3. 将八斗文学的部分不合法文件名进行特殊处理：
   1. 移除文件名中非重复作者的多余数字
   2. 移除部分文件名中无法解析的字符（方块等）
   3. 将所有“诗经”的诗词合并到一个文件中

## 3. 处理要点

* 统计两个数据集/合并数据集的：
  * 各朝代各诗人作品数量
  * 各朝代诗人总数、作品总数
  * 总体的诗人数量、作品数量
* 对于 utf-8 无法解析的字符，进行忽略
* 对于每个 string 进行 strip 操作
* 分离正文和注释
* 由于 strip 的原因，在同一数据集内可能会有相同的诗人存在两个文件
* 对于国学大师数据集，删除 intro 项目
* 对于国学大师数据集，分离 `【注释】【赏析】【译文】`
* 对于国学大师数据集，诗歌正文中的 `{x[d]y}` 数据，转换为`x`（去掉了`{`和`[d]y}`）
* 对于国学大师数据集，应拆分 `\r\n \n \r \n\r`
* 对于两份数据集，去掉正文中的 `【...】（...）[...](...)`
* 对于两份数据集，移除没有正文内容的诗

## 4. 去重方法

对于一首待加入的诗词正文 A，如果在 output 中匹配到了对应的 `朝代-诗人-题目`，则进行查重处理，判断 A 是否要进行舍弃。

对于匹配到的所有 `朝代-诗人-题目` list B，对于 item in B：
* 构建 A 与 item 的 VSM，字频计算方法为 `该字的出现次数 / 当前向量中出现的最大次数`，计算余弦夹角
* 计算 A 与 item 的共有字符比例（将 len A 作为分母）
* Result:
  * 上述两项都达到相似阈值的，舍弃这样的 A
  * 若所有 item 比较之后均未达到阈值，则加入 A
